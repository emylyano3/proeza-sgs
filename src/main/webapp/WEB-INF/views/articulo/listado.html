<!DOCTYPE html>
<html 
	xmlns:th="http://www.thymeleaf.org" 
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" 
	layout:decorator="layout.html">
<body>
	<div id="content" layout:fragment="contenido">
		<link rel="stylesheet" href="../../../resources/jqx/css/jqx.base.css" th:href="@{/resources/jqx/css/jqx.base.css}" type="text/css" />
		<link rel="stylesheet" href="../../../resources/jqx/css/jqx.energyblue.css" th:href="@{/resources/jqx/css/jqx.energyblue.css}" type="text/css" media="screen" />
		
		<div class="row">
			<div class="col-md-12">
				<div class="input-group">
					<input id="filter" type="text" class="form-control" placeholder="Buscar..." th:placeholder="#{control.search-articles}" /> 
					<span class="input-group-btn">
						<button id="eraser" class="btn btn-default" type="button">
							<i class="fa fa-eraser" />
						</button>
					</span>
				</div>
			</div>
		</div>
		<p/>
		<div class="row">
			<div class="col-md-12">
		        <div id="articulos"/>
       		</div>
	    </div>
		<script type="text/javascript" src="../../../resources/jqx/js/jqxcore.js" th:src="@{/resources/jqx/js/jqxcore.js}" />
		<script type="text/javascript" src="../../../resources/jqx/js/jqxdata.js" th:src="@{/resources/jqx/js/jqxdata.js}" />
		<script type="text/javascript" src="../../../resources/jqx/js/jqxbuttons.js" th:src="@{/resources/jqx/js/jqxbuttons.js}" />
		<script type="text/javascript" src="../../../resources/jqx/js/jqxscrollbar.js" th:src="@{/resources/jqx/js/jqxscrollbar.js}" />
		<script type="text/javascript" src="../../../resources/jqx/js/jqxmenu.js" th:src="@{/resources/jqx/js/jqxmenu.js}" />
		<script type="text/javascript" src="../../../resources/jqx/js/jqxgrid.js" th:src="@{/resources/jqx/js/jqxgrid.js}" />
		<script type="text/javascript" src="../../../resources/jqx/js/jqxgrid.selection.js" th:src="@{/resources/jqx/js/jqxgrid.selection.js}" />
		<script type="text/javascript" src="../../../resources/jqx/js/demos.js" th:src="@{/resources/jqx/js/demos.js}" />
		<script type="text/javascript" src="../../../resources/jqx/js/jqxgrid.sort.js" th:src="@{/resources/jqx/js/jqxgrid.sort.js}" />
	    <script type="text/javascript" src="../../../resources/jqx/js/jqxgrid.columnsresize.js" th:src="@{/resources/jqx/js/jqxgrid.columnsresize.js}" /> 
		
	    <script type="text/javascript">

			function replaceAll(text, busca, reemplaza ){
				while (text.toString().indexOf(busca) != -1) {
					text = text.toString().replace(busca,reemplaza);
				}
				return text;
			}

	        $(document).ready(function () {
	            // prepare the data
	            var source =
	            {
	                datatype: "json",
	                dataFields: [
	     	                    { name: 'modelo', type: 'string' },
	     	                    { name: 'descripcion', type: 'string' },
	     	                    { name: 'clase', type: 'string' },
	     	                    { name: 'tipo', type: 'string' },
	     	                    { name: 'marca', type: 'string' },
	     	                    { name: 'precio', type: 'double' },
	                ],
	                id: "id",
	                url: "/proeza-sgs/rest/articulo/search?filter="
	            };
	            var dataAdapter = new $.jqx.dataAdapter(source);
	            
	            // initializa la grilla de articulos
	            $("#articulos").jqxGrid(
	            {
	                width: '100%',
	                source: dataAdapter,
					theme : 'energyblue',
	                columnsresize: true,
	                altrows: true,
			        sortable: true,
	                columns: [
						{ text: 'Modelo', dataField: 'modelo', width: '20%' },
						{ text: 'Descripci√≥n', dataField: 'descripcion', width: '20%' },
						{ text: 'Clase', dataField: 'clase', width: '15%' },
						{ text: 'Tipo', dataField: 'tipo', width: '20%' },
						{ text: 'Marca', dataField: 'marca', width: '15%' },
						{ text: 'Precio', dataField: 'precio', cellsalign: 'right', cellsformat: 'c2', minwidth: '10%' }
	                ]
	            });
	            // Inicializa los botones de la grilla
	            $('#filter').on('input', function() {
	                var filter = $(this).val();
	                var params = "filter=" + replaceAll(filter.trim(), ' ',',');
	                source.url = "/proeza-sgs/rest/articulo/search?" + params;
					// pasando "cells" al comando 'updatebounddata' solo se refrescan los valores de las celdas cuando la cantidad nueva de filas es igual a la anterior
	                $("#articulos").jqxGrid('updatebounddata', 'cells');
	            });
	            $("#clear").click(function () {
	                $("#articulos").jqxGrid('clear');
	                $("#filter").val("");
	            });
	            $("#eraser").click(function () {
	                $("#articulos").jqxGrid('clear');
	                $("#filter").val("");
	            });
	        });
	    </script>
	</div>
</body>
</html>